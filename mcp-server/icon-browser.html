<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Icon Browser</title>
  <style>
    :root {
      --bg: #fff; --fg: #1a1a1a; --border: #e0e0e0; --accent: #0078d4;
      --card-bg: #f5f5f5; --card-hover: #e8e8e8; --swatch-border: #ddd;
      --panel-bg: #fff; --panel-shadow: rgba(0,0,0,0.15);
      --input-bg: #fff;
    }
    [data-theme="dark"] {
      --bg: #1e1e1e; --fg: #e0e0e0; --border: #333; --accent: #4da6ff;
      --card-bg: #2d2d2d; --card-hover: #383838; --swatch-border: #555;
      --panel-bg: #252525; --panel-shadow: rgba(0,0,0,0.4);
      --input-bg: #2d2d2d;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg); color: var(--fg); padding: 16px;
      line-height: 1.4;
    }

    /* ‚îÄ‚îÄ‚îÄ Header ‚îÄ‚îÄ‚îÄ */
    .header { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; }
    .header h1 { font-size: 18px; font-weight: 600; }
    .header .subtitle { font-size: 12px; color: #888; }

    /* ‚îÄ‚îÄ‚îÄ Toolbar ‚îÄ‚îÄ‚îÄ */
    .toolbar {
      display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap;
    }
    .toolbar input {
      flex: 1; min-width: 200px; padding: 7px 12px; border: 1px solid var(--border);
      border-radius: 6px; font-size: 13px; background: var(--input-bg); color: var(--fg);
      outline: none;
    }
    .toolbar input:focus { border-color: var(--accent); box-shadow: 0 0 0 1px var(--accent); }
    .toolbar select {
      padding: 7px 10px; border: 1px solid var(--border); border-radius: 6px;
      font-size: 13px; background: var(--input-bg); color: var(--fg);
    }
    .new-search-btn {
      padding: 7px 14px; border: 1px solid var(--accent); border-radius: 6px;
      font-size: 13px; background: var(--accent); color: #fff; cursor: pointer;
      font-weight: 600; white-space: nowrap; transition: opacity 0.15s;
    }
    .new-search-btn:hover { opacity: 0.85; }
    .new-search-btn:disabled { opacity: 0.5; cursor: wait; }

    /* ‚îÄ‚îÄ‚îÄ Count ‚îÄ‚îÄ‚îÄ */
    .count { font-size: 13px; color: #888; margin-bottom: 12px; }

    /* ‚îÄ‚îÄ‚îÄ Icon Grid ‚îÄ‚îÄ‚îÄ */
    .icons {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 8px;
    }
    .icon-card {
      display: flex; flex-direction: column; align-items: center;
      padding: 12px 8px 8px; border-radius: 8px; background: var(--card-bg);
      border: 1px solid var(--border); cursor: pointer;
      transition: border-color 0.15s, background 0.15s, transform 0.1s;
      text-align: center; overflow: hidden;
    }
    .icon-card:hover {
      border-color: var(--accent); background: var(--card-hover);
      transform: translateY(-1px);
    }

    .icon-preview {
      width: 40px; height: 40px; display: flex; align-items: center;
      justify-content: center; margin-bottom: 6px; flex-shrink: 0;
    }
    .icon-preview img {
      max-width: 40px; max-height: 40px; object-fit: contain;
    }
    .icon-fallback {
      width: 40px; height: 40px; align-items: center; justify-content: center;
      font-size: 20px; color: #999; border: 1px dashed var(--border); border-radius: 4px;
    }
    .icon-cui-name {
      font-size: 10px; color: var(--accent); font-weight: 600;
      display: flex; align-items: center; justify-content: center;
      width: 40px; height: 40px; border: 1px dashed var(--accent);
      border-radius: 4px; opacity: 0.8; word-break: break-all;
      text-align: center; line-height: 1.2; padding: 2px;
    }

    .icon-label {
      font-size: 11px; font-weight: 500; word-break: break-all;
      max-height: 28px; overflow: hidden; line-height: 1.3;
    }
    .icon-source {
      display: inline-block; padding: 1px 6px; border-radius: 8px;
      font-size: 9px; color: #fff; margin-top: 4px; white-space: nowrap;
    }

    /* ‚îÄ‚îÄ‚îÄ Load More ‚îÄ‚îÄ‚îÄ */
    #load-more {
      display: none; margin: 16px auto; padding: 8px 24px;
      border: 1px solid var(--border); border-radius: 6px;
      background: var(--card-bg); color: var(--fg); cursor: pointer;
      font-size: 13px;
    }
    #load-more:hover { border-color: var(--accent); }

    /* ‚îÄ‚îÄ‚îÄ Detail Panel ‚îÄ‚îÄ‚îÄ */
    .selected-panel {
      position: fixed; bottom: -200px; left: 16px; right: 16px;
      background: var(--panel-bg); border: 1px solid var(--border);
      border-radius: 12px 12px 0 0; padding: 16px 20px;
      box-shadow: 0 -4px 20px var(--panel-shadow);
      transition: bottom 0.25s ease;
      z-index: 100; display: flex; align-items: center; gap: 16px;
    }
    .selected-panel.visible { bottom: 0; }

    .selected-preview {
      width: 48px; height: 48px; display: flex; align-items: center;
      justify-content: center; flex-shrink: 0;
    }
    .selected-preview img {
      max-width: 48px; max-height: 48px; object-fit: contain;
    }
    .selected-cui-name {
      font-size: 12px; color: var(--accent); font-weight: 600;
      display: flex; align-items: center; justify-content: center;
      width: 48px; height: 48px; border: 1px dashed var(--accent);
      border-radius: 6px; word-break: break-all; text-align: center;
    }

    .selected-info { flex: 1; min-width: 0; }
    .selected-name { font-size: 14px; font-weight: 600; }
    .selected-meta { display: flex; gap: 8px; align-items: center; margin: 4px 0; flex-wrap: wrap; }
    .selected-source-chip {
      display: inline-block; padding: 2px 8px; border-radius: 8px;
      font-size: 10px; color: #fff;
    }
    .selected-category-chip {
      font-size: 11px; color: #888;
    }
    .selected-usage {
      font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
      font-size: 11px; background: var(--card-bg); padding: 6px 10px;
      border-radius: 4px; border: 1px solid var(--border);
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
      margin-top: 6px; max-width: 100%;
    }

    .selected-actions { display: flex; gap: 8px; flex-shrink: 0; }
    .selected-actions button {
      padding: 6px 14px; border-radius: 6px; border: 1px solid var(--border);
      background: var(--accent); color: #fff; font-size: 12px; cursor: pointer;
      white-space: nowrap;
    }
    .selected-actions button.use-btn {
      background: #107c10; border-color: #107c10; font-weight: 600;
    }
    .selected-actions button.use-btn:hover { background: #0e6b0e; }
    .selected-actions button.use-btn:disabled { opacity: 0.6; cursor: wait; }
    .selected-actions button.close-btn {
      background: transparent; color: var(--fg); border-color: var(--border);
    }

    /* ‚îÄ‚îÄ‚îÄ Toast ‚îÄ‚îÄ‚îÄ */
    .copied {
      position: fixed; top: 16px; right: 16px; background: var(--accent); color: #fff;
      padding: 6px 16px; border-radius: 6px; font-size: 13px; opacity: 0;
      transition: opacity 0.2s; pointer-events: none; z-index: 200;
    }
    .copied.show { opacity: 1; }

    /* ‚îÄ‚îÄ‚îÄ Confirmation Overlay ‚îÄ‚îÄ‚îÄ */
    .confirmation-overlay {
      display: none; position: fixed; inset: 0; z-index: 150;
      background: var(--bg); align-items: center; justify-content: center;
    }
    .confirmation-content {
      text-align: center; padding: 32px; max-width: 400px;
    }
    .confirmation-icon { margin-bottom: 12px; }
    .confirmation-check {
      font-size: 32px; color: #107c10; margin-bottom: 8px;
    }
    .confirmation-title {
      font-size: 18px; font-weight: 600; margin-bottom: 4px;
    }
    .confirmation-name {
      font-size: 14px; color: #888; margin-bottom: 12px;
    }
    .confirmation-usage {
      font-family: 'SF Mono', 'Fira Code', 'Consolas', monospace;
      font-size: 12px; background: var(--card-bg); padding: 8px 14px;
      border-radius: 6px; border: 1px solid var(--border);
      margin-bottom: 16px; word-break: break-all;
    }
    .confirmation-hint {
      font-size: 13px; color: #888; margin-bottom: 16px; line-height: 1.5;
    }
    .confirmation-browse-btn {
      padding: 7px 18px; border: 1px solid var(--border); border-radius: 6px;
      background: transparent; color: var(--fg); font-size: 13px; cursor: pointer;
    }
    .confirmation-browse-btn:hover { border-color: var(--accent); }
  </style>
</head>
<body>
  <div class="header">
    <h1>üé® Icon Browser</h1>
    <span class="subtitle">Browse all Azure & Coherence icons</span>
  </div>

  <div class="toolbar">
    <input id="search" type="text" placeholder="Search icons by name, category, or extension..." />
    <select id="source-filter"><option value="">All sources</option></select>
    <select id="category-filter"><option value="">All categories</option></select>
    <button id="new-search" class="new-search-btn" title="Fetch new results from server">üîç Search</button>
  </div>

  <div class="count" id="count">Loading icons...</div>
  <div class="icons" id="icons"></div>
  <button id="load-more">Load more</button>

  <!-- Detail panel -->
  <div class="selected-panel" id="selected-panel">
    <div class="selected-preview" id="selected-icon"></div>
    <div class="selected-info">
      <div class="selected-name" id="selected-name"></div>
      <div class="selected-meta">
        <span class="selected-source-chip" id="selected-source"></span>
        <span class="selected-category-chip" id="selected-category"></span>
      </div>
      <div class="selected-usage" id="selected-usage"></div>
    </div>
    <div class="selected-actions">
      <button id="use-btn" class="use-btn">‚úì Use this icon</button>
      <button id="copy-btn">Copy usage</button>
      <button id="close-panel" class="close-btn">‚úï</button>
    </div>
  </div>

  <div class="copied" id="copied">Copied!</div>

  <!-- Confirmation overlay -->
  <div class="confirmation-overlay" id="confirmation"></div>

  <script type="module" src="/src/icon-browser.ts"></script>
</body>
</html>
